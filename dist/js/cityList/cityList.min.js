!function(t){function i(i,e){this.config={showLetter:!0,showSearch:!0,callBack:""},this.em=t(i),e&&t.isPlainObject(e)&&t.extend(this.config,e),this.init()}i.prototype.init=function(){this.wrapper=t('<div class="cityPickerWrapper"></div>'),this.picker=t('<div class="cityPicker"></div>'),this.showLetter=t('<div id="showLetter" class="showLetter"><span>A</span></div>'),this.letter=t('<ul class="letter" id="letterList"></ul>'),this.cityContainer=t('<div class="container"></div>'),this.cityListWrap=t('<div class="cityList-wrap"></div>'),this.cityHeader=t('<div class="city-header"><div id= "backPage" class="iconfont icon-fanhui"></div><input type="text" class="input-search" placeholder="北京"><span class="cancel">取消</span></div>'),this.cityTop=t('<div class="city-top"></div>'),this.location=t('<div class="city-location"><h3>定位</h3></div>'),this.locationCity=t('<div class="city"></div>'),this.hotCity=t('<div class="hot-city"><h3>热门城市</h3><ul></ul></div>'),this.letterList=["A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","W","X","Y","Z"],this.mask=t('<div class="mask"></div>'),this.create(),this.bindEvent()},i.prototype.create=function(){var i=this.picker,e=this.wrapper,s=this.showLetter,a=this.letter,c=this.cityContainer,n=this.letterList,o=t("body");i.append(s);var h="";n.forEach(function(t){h+='<li><a href="javascript:;">'+t+"</a></li>"}),a.append(h),i.append(a);var r='<div class="citys">';if(cityData.forEach(function(t){var i=t[0].code;r+='<div class="city-list">',r+='<span class="city-letter" id="'+i+'">'+i+"</span>",t.forEach(function(t){r+='<p data-id="'+t.id+'">'+t.name+"</p>"}),r+="</div>"}),r+="</div>",this.config.location&&(this.cityTop.show(),this.locationCity.html(this.config.location),this.location.append(this.locationCity),this.cityTop.append(this.location)),this.config.hotCity){this.cityTop.show();var d="";this.config.hotCity.forEach(function(t){d+="<li>"+t+"</li>"}),this.hotCity.find("ul").html(d),this.cityTop.append(this.hotCity)}c.append(this.cityHeader),this.cityListWrap.append(this.cityTop),this.cityListWrap.append(r),c.append(this.cityListWrap),i.append(c),e.append(i).append(this.mask),o.append(e)},i.prototype.bindEvent=function(){var i=this;t("body").on("click",".letter li",function(){var e=t(this).find("a").html(),s=t("#"+e).position().top;t(".cityPicker").animate({scrollTop:s},0),t("#showLetter").find("span").html(e),1==i.config.showLetter&&(console.log(2),t("#showLetter").show().delay(500).hide(0))}),this.em.click(function(){t(".cityPickerWrapper").show()}),t("body").on("click","p",function(){if(i.config.callBack){var e=t(this).data("id"),s=t(this).html();i.config.callBack(s,e),i.wrapper.hide()}}),t("#backPage").click(function(){i.wrapper.hide()});var e=t("#letterList"),s=e.find("li"),a=(window.screen.availHeight-90)/s.length,c=[];s.each(function(i,e){c[i]={},c[i].name=t(this).find("a").html(),c[i].h1=a*i+90,c[i].h2=a*(i+1)+90});var e=document.getElementById("letterList");e.addEventListener("touchmove",function(i){i.stopPropagation();var e=event.touches[0].pageY;if(!(e<90)){var s="";c.forEach(function(t){e>=t.h1&&e<=t.h2&&(s=t.name)});var a=t("#"+s).position().top;t(".cityPicker").animate({scrollTop:a},0),t("#showLetter span").html(s),t("#showLetter").show()}},!1),e.addEventListener("touchend",function(){t("#showLetter").hide()},!1),this.cityHeader.find("input").focus(function(t){t.preventDefault(),i.mask.show(),i.cityHeader.addClass("active")}),this.cityHeader.find("input").blur(function(t){t.preventDefault(),i.mask.hide(),i.cityHeader.removeClass("active")})},t.fn.extend({cityList:function(t){return this.each(function(){return new i(this,t)})}})}(jQuery);